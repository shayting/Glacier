(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["back"],{"3b36":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Header"),a("v-overlay",{staticStyle:{"z-index":"999"},attrs:{value:t.isLoading}},[a("v-progress-circular",{attrs:{indeterminate:"",size:"64"}})],1),1!==t.user.role?a("div",{staticClass:"my-container white--text",attrs:{id:"back"}},[a("div",[a("v-row",[a("v-col",{attrs:{cols:"3",sm:"4",lg:"3"}},[t.userPage.avatar?a("v-avatar",{staticClass:"my-10 me-2 back-avatar"},[a("img",{attrs:{src:t.userPage.avatar}})]):a("v-avatar",{staticClass:"my-10 back-avatar"},[a("img",{attrs:{src:t.randomAvatar}})])],1),a("v-col",{staticClass:"d-md-flex justify-md-space-between",attrs:{cols:"9",sm:"8",lg:"9"}},[a("div",{staticClass:"ms-10 ms-sm-0",staticStyle:{position:"relative"}},[a("div",{staticClass:"d-flex flex-wrap align-center"},[t.userPage.userName?a("div",{staticClass:"mt-10 mx-2 mx-sm-4 back-title"},[t._v(t._s(t.userPage.userName))]):a("div",{staticClass:"mt-10 mx-2 mx-sm-4 back-title"},[t._v(t._s(t.userPage.account))]),t.user._id===t.userPage._id?a("v-dialog",{attrs:{width:"500"},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on,s=e.attrs;return[a("v-btn",t._g(t._b({staticClass:"d-none d-sm-block theme-btn mt-10 mx-2 my-2 m-sm-0",attrs:{small:""},on:{click:t.updateProfile}},"v-btn",s,!1),r),[a("v-icon",{attrs:{small:"",left:""}},[t._v("mdi-pencil")]),t._v("編輯 ")],1),a("v-btn",t._g(t._b({staticClass:"d-sm-none mt-10 mx-2",attrs:{icon:"",small:""},on:{click:t.updateProfile}},"v-btn",s,!1),r),[a("v-icon",{attrs:{color:"orange",small:"",left:""}},[t._v("mdi-pencil")])],1)]}}],null,!1,881286262),model:{value:t.dialog2,callback:function(e){t.dialog2=e},expression:"dialog2"}},[a("v-card",[a("v-card-title",[t._v("個人資料")]),a("v-divider"),a("div",{staticClass:"xyCenter flex-column"},[t.changeAvatar?t._e():a("v-avatar",{staticClass:"mt-5",attrs:{size:"100"}},[t.userInfo.avatar?a("img",{attrs:{src:t.userInfo.avatar}}):a("img",{attrs:{src:t.randomAvatar}})]),a("div",{staticClass:"mt-5 avatar-upload",staticStyle:{width:"100px"}},[t.changeAvatar?a("file-pond",{attrs:{imageCropAspectRatio:"1",imageResizeTargetWidth:"250",stylePanelLayout:"compact circle",styleLoadIndicatorPosition:"center bottom",styleProgressIndicatorPosition:"right bottom",styleButtonRemoveItemPosition:"left bottom",styleButtonProcessItemPosition:"right bottom","accepted-file-types":"image/jpeg, image/png","label-idle":"選擇圖片"},on:{updatefiles:function(e){return t.getAvatar(e)}}}):t._e()],1),t.changeAvatar?t._e():a("v-btn",{attrs:{text:"",small:"",color:"primary"},on:{click:function(e){t.changeAvatar=!t.changeAvatar}}},[t._v("更換大頭貼")]),t.changeAvatar?a("v-btn",{attrs:{text:"",small:"",color:"secondary"},on:{click:function(e){t.changeAvatar=!t.changeAvatar}}},[t._v("取消")]):t._e()],1),a("v-card-text",{staticClass:"my-5"},[a("v-form",[a("v-row",{staticClass:"px-sm-10 text-body-1"},[a("v-col",{attrs:{cols:"4"}},[t._v("用戶帳號")]),a("v-col",{attrs:{cpls:"8"}},[t._v(t._s(t.user.account))])],1),a("v-row",{staticClass:"px-sm-10 text-body-1 align-center"},[a("v-col",{attrs:{cols:"4"}},[t._v("用戶名稱")]),a("v-col",{attrs:{cols:"8"}},[a("v-text-field",{attrs:{clearable:""},model:{value:t.form.userName,callback:function(e){t.$set(t.form,"userName",e)},expression:"form.userName"}})],1)],1),a("v-row",{staticClass:"px-sm-10 text-body-1"},[a("v-col",{attrs:{cols:"4"}},[t._v("用戶簡介")]),a("v-col",{attrs:{cols:"8"}},[a("v-textarea",{attrs:{outlined:""},model:{value:t.form.description,callback:function(e){t.$set(t.form,"description",e)},expression:"form.description"}})],1)],1)],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"secondary",text:""},on:{click:function(e){t.dialog2=!1,t.changeAvatar=!1}}},[t._v("取消")]),a("v-btn",{attrs:{color:"primary",text:"",type:"submit",disabled:t.modalSubmitting},on:{click:t.submitModal}},[t._v("儲存")])],1)],1)],1):t._e(),t.user._id===t.$route.params.id||t.followState?t._e():a("v-btn",{staticClass:"theme-btn mt-10 mx-2 my-2 m-sm-0",attrs:{small:""},on:{click:t.follow}},[t._v("+ 追蹤")]),t.user._id!==t.$route.params.id&&t.followState?a("v-btn",{staticClass:"mt-10 mx-2 my-2 m-sm-0",attrs:{outlined:"",color:"#d7f3f5",small:""},on:{click:t.follow}},[t._v("追蹤中")]):t._e()],1),t.userPage.description?a("div",{staticClass:"d-none d-sm-block mx-2 mx-sm-4 mt-sm-5 text-wrapper"},[t._v(t._s(t.splitText))]):t._e()]),a("div",{staticClass:"d-flex mx-10 mx-sm-0 my-6 my-sm-10"},[a("v-dialog",{staticClass:"ma-10",attrs:{width:"500"},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on,s=e.attrs;return[a("div",{staticClass:"text-center mx-2 ms-sm-4"},[a("div",{staticClass:"followModal"},[t._v("音樂")]),a("div",[t._v(t._s(t.tracksCount))])]),a("div",t._g(t._b({staticClass:"text-center mx-2 ms-sm-8"},"div",s,!1),r),[a("div",{staticClass:"followModal"},[t._v("粉絲")]),a("div",[t._v(t._s(t.userPage.followers.length))])]),a("div",t._g(t._b({staticClass:"text-center mx-2 ms-sm-8"},"div",s,!1),r),[a("div",{staticClass:"followModal"},[t._v("追蹤中")]),a("div",[t._v(t._s(t.userPage.following.length))])])]}}],null,!1,1480379620),model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[a("v-card",[a("v-tabs",{attrs:{"fixed-tabs":"",color:"teal"},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("v-tab",{attrs:{href:"#followers"}},[t._v("粉絲")]),a("v-tab",{attrs:{href:"#following"}},[t._v("追蹤中")])],1),a("v-tabs-items",{model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("v-tab-item",{attrs:{value:"followers"}},[a("v-card-text",[t.userPage.followers?a("ul",{staticClass:"ps-0"},t._l(t.userPage.followers,(function(e){return a("li",{key:e._id,staticClass:"d-flex align-center justify-space-between my-2"},[a("div",{staticClass:"d-flex align-center"},[a("v-avatar",[e.users.avatar?a("img",{attrs:{src:e.users.avatar}}):a("img",{attrs:{src:"https://source.boringavatars.com/beam/"+e.users.account}})]),a("router-link",{attrs:{to:"/back/user/"+e.users._id}},[e.users.userName?a("div",{staticClass:"fs-20 mx-5 black--text"},[t._v(t._s(e.users.userName))]):a("div",{staticClass:"fs-20 mx-5 black--text"},[t._v(t._s(e.users.account))])])],1),t.followCheck(e.users._id)?a("v-btn",{attrs:{width:"80",color:"teal",outlined:"",elevation:"0"},on:{click:function(a){return t.followById(e.users._id)}}},[t._v("追蹤中")]):a("v-btn",{staticClass:"white--text",attrs:{width:"80",color:"teal",elevation:"0"},on:{click:function(a){return t.followById(e.users._id)}}},[t._v("追蹤")])],1)})),0):t._e()])],1),a("v-tab-item",{attrs:{value:"following"}},[a("v-card-text",[a("ul",{staticClass:"ps-0"},t._l(t.userPage.following,(function(e){return a("li",{key:e._id,staticClass:"d-flex align-center justify-space-between my-2"},[a("div",{staticClass:"d-flex align-center"},[a("v-avatar",[e.users.avatar?a("img",{attrs:{src:e.users.avatar}}):a("img",{attrs:{src:"https://source.boringavatars.com/beam/"+e.users.account}})]),a("router-link",{attrs:{to:"/back/user/"+e.users._id}},[e.users.userName?a("div",{staticClass:"fs-20 mx-5 black--text"},[t._v(t._s(e.users.userName))]):a("div",{staticClass:"fs-20 mx-5 black--text"},[t._v(t._s(e.users.account))])])],1),t.followCheck(e.users._id)?a("v-btn",{attrs:{width:"80",color:"teal",outlined:"",elevation:"0"},on:{click:function(a){return t.followById(e.users._id)}}},[t._v("追蹤中")]):a("v-btn",{staticClass:"white--text",attrs:{width:"80",color:"teal",elevation:"0"},on:{click:function(a){return t.followById(e.users._id)}}},[t._v("追蹤")])],1)})),0)])],1)],1),a("v-divider"),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"teal",text:""},on:{click:function(e){t.dialog=!1}}},[t._v("關閉")])],1)],1)],1)],1)])],1)],1),a("v-app-bar",{staticClass:"d-flex justify-center",attrs:{color:"secondary",elevation:"2",rounded:""}},[a("div",{staticClass:"px-4 px-sm-6 px-md-10 back-item"},[a("router-link",{attrs:{to:"/back/user/"+this.$route.params.id}},[t._v("ABOUT")])],1),a("div",{staticClass:"px-4 px-sm-6 px-md-10 back-item"},[a("router-link",{attrs:{to:"/back/user/"+this.$route.params.id+"/tracks"}},[t._v("MUSIC")])],1),a("div",{staticClass:"px-4 px-sm-6 px-md-10 back-item"},[a("router-link",{attrs:{to:"/back/user/"+this.$route.params.id+"/playlists"}},[t._v("PLAYLIST")])],1),a("div",{staticClass:"px-4 px-sm-6 px-md-10 back-item"},[a("router-link",{attrs:{to:"/back/user/"+this.$route.params.id+"/likes"}},[t._v("LIKE")])],1)])],1):t._e(),a("router-view",{on:{deleteTrack:function(e){t.tracksCount--}}})],1)},s=[],o=a("1da1"),n=(a("a4d3"),a("e01a"),a("d3b7"),a("ac1f"),a("1276"),a("caad"),a("b0c0"),a("96cf"),a("0418")),i={name:"Back",components:{Header:n["a"]},data:function(){return{attrs:{class:"mb-6",boilerplate:!0,elevation:2},form:{cover:null,userName:"",description:""},followState:!1,userInfo:{},userPage:{tracks:[],followers:[],following:[],account:"",avatar:""},myFollow:{followers:[],following:[]},tracksCount:0,dialog:!1,dialog2:!1,modalSubmitting:!1,tab:null,changeAvatar:!1,isLoading:!1}},methods:{getAvatar:function(t){t[0]&&(this.form.cover=t[0].file)},submitModal:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a,r,s,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(r in t.modalSubmitting=!0,t.isLoading=!0,a=new FormData,t.form)a.append(r,t.form[r]);return e.prev=4,e.next=7,t.api.patch("/users/"+t.user._id,a,{headers:{authorization:"Bearer "+t.user.token}});case 7:return s=e.sent,o=s.data,t.userInfo=o.result,t.dialog2=!1,t.$swal({icon:"success",title:"成功",text:"修改成功"}),t.changeAvatar=!1,e.next=15,t.getOtherUser();case 15:e.next=21;break;case 17:e.prev=17,e.t0=e["catch"](4),console.log(e.t0),t.$swal({icon:"error",title:"錯誤",text:e.t0.response.data.message});case 21:t.modalSubmitting=!1,t.isLoading=!1;case 23:case"end":return e.stop()}}),e,null,[[4,17]])})))()},updateProfile:function(){this.form={cover:this.userInfo.avatar,description:this.userInfo.description,userName:this.userInfo.userName}},getUser:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.api.get("/users/me",{headers:{authorization:"Bearer "+t.user.token}});case 2:a=e.sent,r=a.data,t.userInfo={userName:r.result.userName,description:r.result.description,avatar:r.result.avatar};case 5:case"end":return e.stop()}}),e)})))()},getOtherUser:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a,r,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.next=3,t.api.get("/users/"+t.$route.params.id);case 3:a=e.sent,r=a.data,t.userPage.account=r.result.account,t.userPage.description=r.result.description,t.userPage.avatar=r.result.avatar,t.userPage.userName=r.result.userName,t.userPage._id=r.result._id,t.userPage.tracks=r.result.tracks,s=t.user.following,void 0!==s&&s.some((function(e){return e.users===t.$route.params.id}))?t.followState=!0:t.followState=!1,t.isLoading=!1;case 14:case"end":return e.stop()}}),e)})))()},getUserTracks:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.api.get("/tracks?artist="+t.$route.params.id);case 3:a=e.sent,r=a.data,t.tracksCount=r.result.length,e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),t.$swal({icon:"error",title:"錯誤",text:"取得音樂失敗"});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))()},getPrivate:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.api.get("/tracks/private/"+t.user._id,{headers:{authorization:"Bearer "+t.user.token}});case 3:a=e.sent,r=a.data,t.tracksCount=r.result.length,e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),t.$swal({icon:"error",title:"錯誤",text:"取得音樂失敗"});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))()},follow:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.api.patch("/users/follow/"+t.user.id,{_id:t.$route.params.id},{headers:{authorization:"Bearer "+t.user.token}});case 3:return e.next=5,t.$store.dispatch("user/getUserInfo");case 5:return e.next=7,t.getOtherUser();case 7:return e.next=9,t.getUserFollow();case 9:e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](0),t.$swal({icon:"info",title:"請先登入",text:e.t0.response.data.message});case 14:case"end":return e.stop()}}),e,null,[[0,11]])})))()},followById:function(t){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,e.api.patch("/users/follow/"+e.user.id,{_id:t},{headers:{authorization:"Bearer "+e.user.token}});case 3:return a.next=5,e.$store.dispatch("user/getUserInfo");case 5:return a.next=7,e.getOtherUser();case 7:return a.next=9,e.getUserFollow();case 9:return a.next=11,e.getMyFollow();case 11:a.next=16;break;case 13:a.prev=13,a.t0=a["catch"](0),e.$swal({icon:"info",title:"請先登入",text:a.t0.response.data.message});case 16:case"end":return a.stop()}}),a,null,[[0,13]])})))()},getUserFollow:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.api.get("/users/"+t.$route.params.id+"/follow");case 2:a=e.sent,r=a.data,t.userPage.followers=r.result.followers,t.userPage.following=r.result.following;case 6:case"end":return e.stop()}}),e)})))()},getMyFollow:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.api.get("/users/"+t.user._id+"/myfollow");case 2:a=e.sent,r=a.data,t.myFollow.following=r.result.following;case 5:case"end":return e.stop()}}),e)})))()},renderNew:function(){this.getOtherUser(),this.getUserFollow(),this.getMyFollow()},followCheck:function(t){return this.myFollow.following.some((function(e){return e.users._id===t}))}},computed:{splitText:function(){return this.userPage.description.split(/[\r\n]/)[0]+"..."},randomAvatar:function(){if(null===this.userPage.avatar)return"https://source.boringavatars.com/beam/"+this.userPage.account}},created:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a=["About","Mytracks","Myplaylists","Mylikes"].includes(t.$route.name),a&&(t.getOtherUser(),t.getUserFollow(),t.user._id.length>0?(t.getUser(),t.getMyFollow(),t.user._id===t.$route.params.id?t.getPrivate():t.getUserTracks()):t.getUserTracks());case 2:case"end":return e.stop()}}),e)})))()}},c=i,l=a("2877"),u=a("6544"),d=a.n(u),v=a("40dc"),m=a("8212"),f=a("8336"),g=a("b0af"),p=a("99d9"),x=a("62ad"),w=a("169a"),b=a("ce7e"),h=a("4bd4"),_=a("132d"),k=a("a797"),C=a("490a"),y=a("0fd9"),P=a("2fa4"),I=a("71a3"),R=a("c671"),$=a("fe57"),A=a("aac8"),V=a("8654"),U=a("a844"),O=Object(l["a"])(c,r,s,!1,null,null,null);e["default"]=O.exports;d()(O,{VAppBar:v["a"],VAvatar:m["a"],VBtn:f["a"],VCard:g["a"],VCardActions:p["a"],VCardText:p["c"],VCardTitle:p["d"],VCol:x["a"],VDialog:w["a"],VDivider:b["a"],VForm:h["a"],VIcon:_["a"],VOverlay:k["a"],VProgressCircular:C["a"],VRow:y["a"],VSpacer:P["a"],VTab:I["a"],VTabItem:R["a"],VTabs:$["a"],VTabsItems:A["a"],VTextField:V["a"],VTextarea:U["a"]})}}]);
//# sourceMappingURL=back.71075c81.js.map